(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{324:function(e,t,a){"use strict";a.r(t);var s=a(14),n=Object(s.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("div",{attrs:{id:"google_translate_element"}}),e._v(" "),t("h1",{attrs:{id:"extensions-guide"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#extensions-guide"}},[e._v("#")]),e._v(" Extensions Guide")]),e._v(" "),t("p",[e._v("This guide have some instructions and tips on how to create a new Tachimanga extension. Please "),t("strong",[e._v("read it carefully")]),e._v(" if you don't have any experience on the required languages and knowledges.")]),e._v(" "),t("h2",{attrs:{id:"table-of-contents"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#table-of-contents"}},[e._v("#")]),e._v(" Table of Contents")]),e._v(" "),t("ol",[t("li",[t("a",{attrs:{href:"#prerequisites"}},[e._v("Prerequisites")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#writing-an-extension"}},[e._v("Writing an extension")]),e._v(" "),t("ol",[t("li",[t("a",{attrs:{href:"#setting-up-a-new-gradle-module"}},[e._v("Setting up a new Gradle module")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#core-dependencies"}},[e._v("Core dependencies")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#extension-main-class"}},[e._v("Extension main class")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#extension-call-flow"}},[e._v("Extension call flow")])]),e._v(" "),t("li",[t("a",{attrs:{href:"#misc-notes"}},[e._v("Misc notes")])])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#building"}},[e._v("Building")])])]),e._v(" "),t("h2",{attrs:{id:"prerequisites"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),t("p",[e._v("Before you start, please note that the ability to use following technologies is "),t("strong",[e._v("required")]),e._v(" and that existing contributors will not actively teach them to you.")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://kotlinlang.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Kotlin"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("Web scraping\n"),t("ul",[t("li",[t("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTML",target:"_blank",rel:"noopener noreferrer"}},[e._v("HTML"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors",target:"_blank",rel:"noopener noreferrer"}},[e._v("CSS selectors"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://square.github.io/okhttp/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OkHttp"),t("OutboundLink")],1)]),e._v(" "),t("li",[t("a",{attrs:{href:"https://jsoup.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("JSoup"),t("OutboundLink")],1)])])])]),e._v(" "),t("h2",{attrs:{id:"writing-an-extension"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#writing-an-extension"}},[e._v("#")]),e._v(" Writing an extension")]),e._v(" "),t("p",[e._v("The quickest way to get started is to copy an existing extension's folder structure and renaming it as needed. We also recommend reading through a few existing extensions' code before you start.")]),e._v(" "),t("h3",{attrs:{id:"setting-up-a-new-gradle-module"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-a-new-gradle-module"}},[e._v("#")]),e._v(" Setting up a new Gradle module")]),e._v(" "),t("p",[e._v("Each extension should reside in "),t("code",[e._v("src/<lang>/<mysourcename>")]),e._v(". Use "),t("code",[e._v("all")]),e._v(" as "),t("code",[e._v("<lang>")]),e._v(" if your target source supports multiple languages or if it could support multiple sources.")]),e._v(" "),t("p",[e._v("The "),t("code",[e._v("<lang>")]),e._v(" used in the folder inside "),t("code",[e._v("src")]),e._v(" should be the major "),t("code",[e._v("language")]),e._v(" part. For example, if you will be creating a "),t("code",[e._v("pt-BR")]),e._v(" source, use "),t("code",[e._v("<lang>")]),e._v(" here as "),t("code",[e._v("pt")]),e._v(" only. Inside the source class, use the full locale string instead.")]),e._v(" "),t("h3",{attrs:{id:"loading-a-subset-of-gradle-modules"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#loading-a-subset-of-gradle-modules"}},[e._v("#")]),e._v(" Loading a subset of Gradle modules")]),e._v(" "),t("p",[e._v("By default, all individual extensions are loaded for local development.\nThis may be inconvenient if you only need to work on one extension at a time.")]),e._v(" "),t("p",[e._v("To adjust which modules are loaded, make adjustments to the "),t("code",[e._v("settings.gradle.kts")]),e._v(" file as needed.")]),e._v(" "),t("h4",{attrs:{id:"extension-file-structure"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#extension-file-structure"}},[e._v("#")]),e._v(" Extension file structure")]),e._v(" "),t("p",[e._v("The simplest extension structure looks like this:")]),e._v(" "),t("div",{staticClass:"language-console extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("$ tree src/<lang>/<mysourcename>/\nsrc/<lang>/<mysourcename>/\n├── build.gradle\n├── res\n│   ├── mipmap-hdpi\n│   │   └── ic_launcher.png\n│   ├── mipmap-mdpi\n│   │   └── ic_launcher.png\n│   ├── mipmap-xhdpi\n│   │   └── ic_launcher.png\n│   ├── mipmap-xxhdpi\n│   │   └── ic_launcher.png\n│   ├── mipmap-xxxhdpi\n│   │   └── ic_launcher.png\n│   └── web_hi_res_512.png\n└── src\n    └── eu\n        └── kanade\n            └── tachiyomi\n                └── extension\n                    └── <lang>\n                        └── <mysourcename>\n                            └── <MySourceName>.kt\n\n13 directories, 9 files\n")])])]),t("h4",{attrs:{id:"build-gradle"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#build-gradle"}},[e._v("#")]),e._v(" build.gradle")]),e._v(" "),t("p",[e._v("Make sure that your new extension's "),t("code",[e._v("build.gradle")]),e._v(" file follows the following structure:")]),e._v(" "),t("div",{staticClass:"language-gradle extra-class"},[t("pre",{pre:!0,attrs:{class:"language-gradle"}},[t("code",[e._v("ext "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    extName "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'<My source name>'")]),e._v("\n    pkgNameSuffix "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'<lang>.<mysourcename>'")]),e._v("\n    extClass "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'.<MySourceName>'")]),e._v("\n    extVersionCode "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("apply")]),e._v(" from"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token interpolation-string"}},[t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"')]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[e._v("$")]),t("span",{pre:!0,attrs:{class:"token expression"}},[e._v("rootDir")])]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('/common.gradle"')])]),e._v("\n")])])]),t("table",[t("thead",[t("tr",[t("th",[e._v("Field")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[t("code",[e._v("extName")])]),e._v(" "),t("td",[e._v("The name of the extension.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("pkgNameSuffix")])]),e._v(" "),t("td",[e._v("A unique suffix added to "),t("code",[e._v("eu.kanade.tachiyomi.extension")]),e._v(". The language and the site name should be enough. Remember your extension code implementation must be placed in this package.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("extClass")])]),e._v(" "),t("td",[e._v("Points to the class that implements "),t("code",[e._v("Source")]),e._v(". You can use a relative path starting with a dot (the package name is the base path). This is used to find and instantiate the source(s).")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("extVersionCode")])]),e._v(" "),t("td",[e._v("The extension version code. This must be a positive integer and incremented with any change to the code.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("libVersion")])]),e._v(" "),t("td",[e._v("(Optional, defaults to "),t("code",[e._v("1.4")]),e._v(") The version of the "),t("a",{attrs:{href:"https://github.com/tachiyomiorg/extensions-lib",target:"_blank",rel:"noopener noreferrer"}},[e._v("extensions library"),t("OutboundLink")],1),e._v(" used.")])])])]),e._v(" "),t("p",[e._v("The extension's version name is generated automatically by concatenating "),t("code",[e._v("libVersion")]),e._v(" and "),t("code",[e._v("extVersionCode")]),e._v(". With the example used above, the version would be "),t("code",[e._v("1.4.1")]),e._v(".")]),e._v(" "),t("h3",{attrs:{id:"core-dependencies"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#core-dependencies"}},[e._v("#")]),e._v(" Core dependencies")]),e._v(" "),t("h4",{attrs:{id:"extension-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#extension-api"}},[e._v("#")]),e._v(" Extension API")]),e._v(" "),t("p",[e._v("Extensions rely on "),t("a",{attrs:{href:"https://github.com/tachiyomiorg/extensions-lib",target:"_blank",rel:"noopener noreferrer"}},[e._v("extensions-lib"),t("OutboundLink")],1),e._v(", which provides some interfaces and stubs from the "),t("a",{attrs:{href:"https://github.com/tachiyomiorg/tachiyomi",target:"_blank",rel:"noopener noreferrer"}},[e._v("app"),t("OutboundLink")],1),e._v(" for compilation purposes. The actual implementations can be found "),t("a",{attrs:{href:"https://github.com/tachiyomiorg/tachiyomi/tree/main/app/src/main/java/eu/kanade/tachiyomi/source",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),t("OutboundLink")],1),e._v(". Referencing the actual implementation will help with understanding extensions' call flow.")]),e._v(" "),t("h4",{attrs:{id:"dataimage-library"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dataimage-library"}},[e._v("#")]),e._v(" DataImage library")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/tachiyomiorg/extensions/tree/main/lib/dataimage",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("lib-dataimage")]),t("OutboundLink")],1),e._v(" is a library for handling "),t("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs",target:"_blank",rel:"noopener noreferrer"}},[e._v("base 64 encoded image data"),t("OutboundLink")],1),e._v(" using an "),t("a",{attrs:{href:"https://square.github.io/okhttp/interceptors/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OkHttp interceptor"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("div",{staticClass:"language-gradle extra-class"},[t("pre",{pre:!0,attrs:{class:"language-gradle"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("dependencies")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("implementation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("project")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("':lib-dataimage'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("h4",{attrs:{id:"i18n-library"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#i18n-library"}},[e._v("#")]),e._v(" i18n library")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/tachiyomiorg/extensions/tree/main/lib/i18n",target:"_blank",rel:"noopener noreferrer"}},[t("code",[e._v("lib-i18n")]),t("OutboundLink")],1),e._v(" is a library for handling internationalization in the sources. It allows loading "),t("code",[e._v(".properties")]),e._v(" files with messages located under the "),t("code",[e._v("assets/i18n")]),e._v(" folder of each extension, that can be used to translate strings under the source.")]),e._v(" "),t("div",{staticClass:"language-gradle extra-class"},[t("pre",{pre:!0,attrs:{class:"language-gradle"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("dependencies")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("implementation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("project")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("':lib-i18n'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("h3",{attrs:{id:"extension-main-class"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#extension-main-class"}},[e._v("#")]),e._v(" Extension main class")]),e._v(" "),t("p",[e._v("The class which is referenced and defined by "),t("code",[e._v("extClass")]),e._v(" in "),t("code",[e._v("build.gradle")]),e._v(". This class should implement either "),t("code",[e._v("SourceFactory")]),e._v(" or extend one of the "),t("code",[e._v("Source")]),e._v(" implementations: "),t("code",[e._v("HttpSource")]),e._v(" or "),t("code",[e._v("ParsedHttpSource")]),e._v(".")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Class")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[t("code",[e._v("SourceFactory")])]),e._v(" "),t("td",[e._v("Used to expose multiple "),t("code",[e._v("Source")]),e._v("s. Use this in case of a source that supports multiple languages or mirrors of the same website.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("HttpSource")])]),e._v(" "),t("td",[e._v("For online source, where requests are made using HTTP.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("ParsedHttpSource")])]),e._v(" "),t("td",[e._v("Similar to "),t("code",[e._v("HttpSource")]),e._v(", but has methods useful for scraping pages.")])])])]),e._v(" "),t("h4",{attrs:{id:"main-class-key-variables"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#main-class-key-variables"}},[e._v("#")]),e._v(" Main class key variables")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Field")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[t("code",[e._v("name")])]),e._v(" "),t("td",[e._v('Name displayed in the "Sources" tab in Tachiyomi.')])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("baseUrl")])]),e._v(" "),t("td",[e._v("Base URL of the source without any trailing slashes.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("lang")])]),e._v(" "),t("td",[e._v("An ISO 639-1 compliant language code (two letters in lower case in most cases, but can also include the country/dialect part by using a simple dash character).")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("id")])]),e._v(" "),t("td",[e._v("Identifier of your source, automatically set in "),t("code",[e._v("HttpSource")]),e._v(". It should only be manually overriden if you need to copy an existing autogenerated ID.")])])])]),e._v(" "),t("h3",{attrs:{id:"extension-call-flow"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#extension-call-flow"}},[e._v("#")]),e._v(" Extension call flow")]),e._v(" "),t("h4",{attrs:{id:"popular-manga"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#popular-manga"}},[e._v("#")]),e._v(" Popular Manga")]),e._v(" "),t("p",[e._v("a.k.a. the Browse source entry point in the app (invoked by tapping on the source name).")]),e._v(" "),t("ul",[t("li",[e._v("The app calls "),t("code",[e._v("fetchPopularManga")]),e._v(" which should return a "),t("code",[e._v("MangasPage")]),e._v(" containing the first batch of found "),t("code",[e._v("SManga")]),e._v(" entries.\n"),t("ul",[t("li",[e._v("This method supports pagination. When user scrolls the manga list and more results must be fetched, the app calls it again with increasing "),t("code",[e._v("page")]),e._v(" values (starting with "),t("code",[e._v("page=1")]),e._v("). This continues while "),t("code",[e._v("MangasPage.hasNextPage")]),e._v(" is passed as "),t("code",[e._v("true")]),e._v(" and "),t("code",[e._v("MangasPage.mangas")]),e._v(" is not empty.")])])]),e._v(" "),t("li",[e._v("To show the list properly, the app needs "),t("code",[e._v("url")]),e._v(", "),t("code",[e._v("title")]),e._v(" and "),t("code",[e._v("thumbnail_url")]),e._v(". You "),t("strong",[e._v("must")]),e._v(" set them here. The rest of the fields could be filled later (refer to Manga Details below).\n"),t("ul",[t("li",[e._v("You should set "),t("code",[e._v("thumbnail_url")]),e._v(" if is available, if not, "),t("code",[e._v("getMangaDetails")]),e._v(" will be "),t("strong",[e._v("immediately")]),e._v(" called (this will increase network calls heavily and should be avoided).")])])])]),e._v(" "),t("h4",{attrs:{id:"latest-manga"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#latest-manga"}},[e._v("#")]),e._v(" Latest Manga")]),e._v(" "),t("p",[e._v('a.k.a. the Latest source entry point in the app (invoked by tapping on the "Latest" button beside the source name).')]),e._v(" "),t("ul",[t("li",[e._v("Enabled if "),t("code",[e._v("supportsLatest")]),e._v(" is "),t("code",[e._v("true")]),e._v(" for a source")]),e._v(" "),t("li",[e._v("Similar to popular manga, but should be fetching the latest entries from a source.")])]),e._v(" "),t("h4",{attrs:{id:"manga-search"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#manga-search"}},[e._v("#")]),e._v(" Manga Search")]),e._v(" "),t("ul",[t("li",[e._v("When the user searches inside the app, "),t("code",[e._v("fetchSearchManga")]),e._v(" will be called and the rest of the flow is similar to what happens with "),t("code",[e._v("fetchPopularManga")]),e._v(".\n"),t("ul",[t("li",[e._v("If search functionality is not available, return "),t("code",[e._v("Observable.just(MangasPage(emptyList(), false))")])])])]),e._v(" "),t("li",[t("code",[e._v("getFilterList")]),e._v(" will be called to get all filters and filter types.")])]),e._v(" "),t("h5",{attrs:{id:"filters"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#filters"}},[e._v("#")]),e._v(" Filters")]),e._v(" "),t("p",[e._v("The search flow have support to filters that can be added to a "),t("code",[e._v("FilterList")]),e._v(" inside the "),t("code",[e._v("getFilterList")]),e._v(" method. When the user changes the filters' state, they will be passed to the "),t("code",[e._v("searchRequest")]),e._v(", and they can be iterated to create the request (by getting the "),t("code",[e._v("filter.state")]),e._v(" value, where the type varies depending on the "),t("code",[e._v("Filter")]),e._v(" used). You can check the filter types available "),t("a",{attrs:{href:"https://github.com/tachiyomiorg/tachiyomi/blob/main/source-api/src/commonMain/kotlin/eu/kanade/tachiyomi/source/model/Filter.kt",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),t("OutboundLink")],1),e._v(" and in the table below.")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("Filter")]),e._v(" "),t("th",[e._v("State type")]),e._v(" "),t("th",[e._v("Description")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[t("code",[e._v("Filter.Header")])]),e._v(" "),t("td",[e._v("None")]),e._v(" "),t("td",[e._v("A simple header. Useful for separating sections in the list or showing any note or warning to the user.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("Filter.Separator")])]),e._v(" "),t("td",[e._v("None")]),e._v(" "),t("td",[e._v("A line separator. Useful for visual distinction between sections.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("Filter.Select<V>")])]),e._v(" "),t("td",[t("code",[e._v("Int")])]),e._v(" "),t("td",[e._v("A select control, similar to HTML's "),t("code",[e._v("<select>")]),e._v(". Only one item can be selected, and the state is the index of the selected one.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("Filter.Text")])]),e._v(" "),t("td",[t("code",[e._v("String")])]),e._v(" "),t("td",[e._v("A text control, similar to HTML's "),t("code",[e._v('<input type="text">')]),e._v(".")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("Filter.CheckBox")])]),e._v(" "),t("td",[t("code",[e._v("Boolean")])]),e._v(" "),t("td",[e._v("A checkbox control, similar to HTML's "),t("code",[e._v('<input type="checkbox">')]),e._v(". The state is "),t("code",[e._v("true")]),e._v(" if it's checked.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("Filter.TriState")])]),e._v(" "),t("td",[t("code",[e._v("Int")])]),e._v(" "),t("td",[e._v("A enhanced checkbox control that supports an excluding state. The state can be compared with "),t("code",[e._v("STATE_IGNORE")]),e._v(", "),t("code",[e._v("STATE_INCLUDE")]),e._v(" and "),t("code",[e._v("STATE_EXCLUDE")]),e._v(" constants of the class.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("Filter.Group<V>")])]),e._v(" "),t("td",[t("code",[e._v("List<V>")])]),e._v(" "),t("td",[e._v("A group of filters (preferentially of the same type). The state will be a "),t("code",[e._v("List")]),e._v(" with all the states.")])]),e._v(" "),t("tr",[t("td",[t("code",[e._v("Filter.Sort")])]),e._v(" "),t("td",[t("code",[e._v("Selection")])]),e._v(" "),t("td",[e._v("A control for sorting, with support for the ordering. The state indicates which item index is selected and if the sorting is "),t("code",[e._v("ascending")]),e._v(".")])])])]),e._v(" "),t("p",[e._v("All control filters can have a default state set. It's usually recommended if the source have filters to make the initial state match the popular manga list, so when the user open the filter sheet, the state is equal and represents the current manga showing.")]),e._v(" "),t("p",[e._v("The "),t("code",[e._v("Filter")]),e._v(" classes can also be extended, so you can create new custom filters like the "),t("code",[e._v("UriPartFilter")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language-kotlin extra-class"},[t("pre",{pre:!0,attrs:{class:"language-kotlin"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("open")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("class")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("UriPartFilter")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("displayName"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" String"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("private")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" vals"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" Array"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Pair"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("String"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" String"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v("\n    Filter"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("Select"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("String"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("displayName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" vals"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("map")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" it"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("first "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("toTypedArray")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("fun")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("toUriPart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" vals"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("state"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("second\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("h4",{attrs:{id:"manga-details"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#manga-details"}},[e._v("#")]),e._v(" Manga Details")]),e._v(" "),t("ul",[t("li",[e._v("When user taps on a manga, "),t("code",[e._v("getMangaDetails")]),e._v(" and "),t("code",[e._v("getChapterList")]),e._v(" will be called and the results will be cached.\n"),t("ul",[t("li",[e._v("A "),t("code",[e._v("SManga")]),e._v(" entry is identified by it's "),t("code",[e._v("url")]),e._v(".")])])]),e._v(" "),t("li",[t("code",[e._v("getMangaDetails")]),e._v(" is called to update a manga's details from when it was initialized earlier.\n"),t("ul",[t("li",[t("code",[e._v("SManga.initialized")]),e._v(" tells the app if it should call "),t("code",[e._v("getMangaDetails")]),e._v(". If you are overriding "),t("code",[e._v("getMangaDetails")]),e._v(", make sure to pass it as "),t("code",[e._v("true")]),e._v(".")]),e._v(" "),t("li",[t("code",[e._v("SManga.genre")]),e._v(" is a string containing list of all genres separated with "),t("code",[e._v('", "')]),e._v(".")]),e._v(" "),t("li",[t("code",[e._v("SManga.status")]),e._v(' is an "enum" value. Refer to '),t("a",{attrs:{href:"https://github.com/tachiyomiorg/extensions-lib/blob/main/library/src/main/java/eu/kanade/tachiyomi/source/model/SManga.kt#L24",target:"_blank",rel:"noopener noreferrer"}},[e._v("the values in the "),t("code",[e._v("SManga")]),e._v(" companion object"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("li",[e._v("During a backup, only "),t("code",[e._v("url")]),e._v(" and "),t("code",[e._v("title")]),e._v(" are stored. To restore the rest of the manga data, the app calls "),t("code",[e._v("getMangaDetails")]),e._v(", so all fields should be (re)filled in if possible.")]),e._v(" "),t("li",[e._v("If a "),t("code",[e._v("SManga")]),e._v(" is cached, "),t("code",[e._v("getMangaDetails")]),e._v(" will be only called when the user does a manual update (Swipe-to-Refresh).")])])]),e._v(" "),t("li",[t("code",[e._v("getChapterList")]),e._v(" is called to display the chapter list.\n"),t("ul",[t("li",[t("strong",[e._v("The list should be sorted descending by the source order")]),e._v(".")])])]),e._v(" "),t("li",[t("code",[e._v("getMangaUrl")]),e._v(' is called when the user taps "Open in WebView".\n'),t("ul",[t("li",[e._v("If the source uses an API to fetch the data, consider overriding this method to return the manga absolute URL in the website instead.")]),e._v(" "),t("li",[e._v("It defaults to the URL provided to the request in "),t("code",[e._v("mangaDetailsRequest")]),e._v(".")])])])]),e._v(" "),t("h4",{attrs:{id:"chapter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chapter"}},[e._v("#")]),e._v(" Chapter")]),e._v(" "),t("ul",[t("li",[e._v("After a chapter list for the manga is fetched and the app is going to cache the data, "),t("code",[e._v("prepareNewChapter")]),e._v(" will be called.")]),e._v(" "),t("li",[t("code",[e._v("SChapter.date_upload")]),e._v(" is the "),t("a",{attrs:{href:"https://en.wikipedia.org/wiki/Unix_time",target:"_blank",rel:"noopener noreferrer"}},[e._v("UNIX Epoch time"),t("OutboundLink")],1),e._v(" "),t("strong",[e._v("expressed in milliseconds")]),e._v(".\n"),t("ul",[t("li",[t("p",[e._v("If you don't pass "),t("code",[e._v("SChapter.date_upload")]),e._v(" and leave it zero, the app will use the default date instead, but it's recommended to always fill it if it's available.")])]),e._v(" "),t("li",[t("p",[e._v("To get the time in milliseconds from a date string, you can use a "),t("code",[e._v("SimpleDateFormat")]),e._v(" like in the example below.")]),e._v(" "),t("div",{staticClass:"language-kotlin extra-class"},[t("pre",{pre:!0,attrs:{class:"language-kotlin"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("private")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("fun")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("parseDate")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("dateStr"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" String"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(":")]),e._v(" Long "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" runCatching "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" DATE_FORMATTER"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("parse")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("dateStr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("time "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("getOrNull")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("?:")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0L")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("companion")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("object")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("private")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("val")]),e._v(" DATE_FORMATTER "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("by")]),e._v(" lazy "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("SimpleDateFormat")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),t("span",{pre:!0,attrs:{class:"token string-literal singleline"}},[t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"yyyy-MM-dd HH:mm:ss"')])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" Locale"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("ENGLISH"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),t("p",[e._v("Make sure you make the "),t("code",[e._v("SimpleDateFormat")]),e._v(" a class constant or variable so it doesn't get recreated for every chapter. If you need to parse or format dates in manga description, create another instance since "),t("code",[e._v("SimpleDateFormat")]),e._v(" is not thread-safe.")])]),e._v(" "),t("li",[t("p",[e._v("If the parsing have any problem, make sure to return "),t("code",[e._v("0L")]),e._v(" so the app will use the default date instead.")])]),e._v(" "),t("li",[t("p",[e._v("The app will overwrite dates of existing old chapters "),t("strong",[e._v("UNLESS")]),e._v(" "),t("code",[e._v("0L")]),e._v(" is returned.")])]),e._v(" "),t("li",[t("p",[e._v("The default date has "),t("a",{attrs:{href:"https://github.com/tachiyomiorg/tachiyomi/pull/7197",target:"_blank",rel:"noopener noreferrer"}},[e._v("changed"),t("OutboundLink")],1),e._v(" in preview ≥ r4442 or stable > 0.13.4.")]),e._v(" "),t("ul",[t("li",[e._v("In older versions, the default date is always the fetch date.")]),e._v(" "),t("li",[e._v("In newer versions, this is the same if every (new) chapter has "),t("code",[e._v("0L")]),e._v(" returned.")]),e._v(" "),t("li",[e._v("However, if the source only provides the upload date of the latest chapter, you can now set it to the latest chapter and leave other chapters default. The app will automatically set it (instead of fetch date) to every new chapter and leave old chapters' dates untouched.")])])])])]),e._v(" "),t("li",[t("code",[e._v("getChapterUrl")]),e._v(' is called when the user taps "Open in WebView" in the reader.\n'),t("ul",[t("li",[e._v("If the source uses an API to fetch the data, consider overriding this method to return the chapter absolute URL in the website instead.")]),e._v(" "),t("li",[e._v("It defaults to the URL provided to the request in "),t("code",[e._v("pageListRequest")]),e._v(".")])])])]),e._v(" "),t("h4",{attrs:{id:"chapter-pages"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chapter-pages"}},[e._v("#")]),e._v(" Chapter Pages")]),e._v(" "),t("ul",[t("li",[e._v("When user opens a chapter, "),t("code",[e._v("getPageList")]),e._v(" will be called and it will return a list of "),t("code",[e._v("Page")]),e._v("s.")]),e._v(" "),t("li",[e._v("While a chapter is open in the reader or is being downloaded, "),t("code",[e._v("fetchImageUrl")]),e._v(" will be called to get URLs for each page of the manga if the "),t("code",[e._v("Page.imageUrl")]),e._v(" is empty.")]),e._v(" "),t("li",[e._v("If the source provides all the "),t("code",[e._v("Page.imageUrl")]),e._v("'s directly, you can fill them and let the "),t("code",[e._v("Page.url")]),e._v(" empty, so the app will skip the "),t("code",[e._v("fetchImageUrl")]),e._v(" source and call directly "),t("code",[e._v("fetchImage")]),e._v(".")]),e._v(" "),t("li",[e._v("The "),t("code",[e._v("Page.url")]),e._v(" and "),t("code",[e._v("Page.imageUrl")]),e._v(" attributes "),t("strong",[e._v("should be set as an absolute URL")]),e._v(".")]),e._v(" "),t("li",[e._v("Chapter pages numbers start from "),t("code",[e._v("0")]),e._v(".")]),e._v(" "),t("li",[e._v("The list of "),t("code",[e._v("Page")]),e._v("s should be returned already sorted, the "),t("code",[e._v("index")]),e._v(" field is ignored.")])]),e._v(" "),t("h3",{attrs:{id:"misc-notes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#misc-notes"}},[e._v("#")]),e._v(" Misc notes")]),e._v(" "),t("ul",[t("li",[e._v("Sometimes you may find no use for some inherited methods. If so just override them and throw exceptions: "),t("code",[e._v('throw UnsupportedOperationException("Not used.")')])]),e._v(" "),t("li",[e._v("You probably will find "),t("code",[e._v("getUrlWithoutDomain")]),e._v(" useful when parsing the target source URLs. Keep in mind there's a current issue with spaces in the URL though, so if you use it, replace all spaces with URL encoded characters (like "),t("code",[e._v("%20")]),e._v(").")]),e._v(" "),t("li",[e._v("If possible try to stick to the general workflow from "),t("code",[e._v("HttpSource")]),e._v("/"),t("code",[e._v("ParsedHttpSource")]),e._v("; breaking them may cause you more headache than necessary.")])]),e._v(" "),t("h4",{attrs:{id:"update-strategy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#update-strategy"}},[e._v("#")]),e._v(" Update strategy")]),e._v(" "),t("p",[e._v("There is some cases where titles in a source will always only have the same chapter list (i.e. immutable), and don't need to be included in a global update of the app because of that, saving a lot of requests and preventing causing unnecessary damage to the source servers. To change the update strategy of a "),t("code",[e._v("SManga")]),e._v(", use the "),t("code",[e._v("update_strategy")]),e._v(" field. You can find below a description of the current possible values.")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("UpdateStrategy.ALWAYS_UPDATE")]),e._v(": Titles marked as always update will be included in the library update if they aren't excluded by additional restrictions.")]),e._v(" "),t("li",[t("code",[e._v("UpdateStrategy.ONLY_FETCH_ONCE")]),e._v(": Titles marked as only fetch once will be automatically skipped during library updates. Useful for cases where the series is previously known to be finished and have only a single chapter, for example.")])]),e._v(" "),t("p",[e._v("If not set, it defaults to "),t("code",[e._v("ALWAYS_UPDATE")]),e._v(".")]),e._v(" "),t("h2",{attrs:{id:"building"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#building"}},[e._v("#")]),e._v(" Building")]),e._v(" "),t("p",[e._v("APKs can be created in Android Studio via "),t("code",[e._v("Build > Build Bundle(s) / APK(s) > Build APK(s)")]),e._v(" or "),t("code",[e._v("Build > Generate Signed Bundle / APK")]),e._v(".")])])}),[],!1,null,null,null);t.default=n.exports}}]);